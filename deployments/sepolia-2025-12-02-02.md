# ECS V2 Sepolia Deployment - 2025-12-02-02

**Date:** December 2, 2025  
**Network:** Sepolia Testnet (Chain ID: 11155111)  
**Deployment Number:** 02 (Clean deployment with simplified CredentialResolver)

## Changes from Deployment 01

This is a clean redeployment with the simplified **single-label CredentialResolver** architecture:
- Removed `labelhash` parameter from all setter/getter functions
- CredentialResolver is now owner-only (no per-label authorization)
- Single-level storage mappings (no labelhash key)
- Simpler `resolve()` function that ignores name parameter

## Deployed Contracts

| Contract | Address | Transaction Hash |
|----------|---------|-------------------|
| ECS Registry | `0xC052964dF22319FF79E1ab4BbD08897df81e4B95` | `0xa369008b7ff0be4cdb503edc3a91cebfd3e028b90894e3030dddb1609d76798e` |
| ECS Registrar | `0x83E1b31806e6A3BC587A0C9b8582e006c880c9B7` | `0x743ca84888e87bcefc2a2e1dc0ed472976992d15f736705ad2738adb63f23f0f` |
| Credential Resolver | `0x4a818ae07f661EDFfbaa4aaFdab9c00085Ff6C78` | `0x148247026d940d44605df75c646833a5ad2530a7c4fae2c076f4f22a23ce49e4` |

## Configuration

- **Root Name:** `ecs.eth`
- **Root Node:** `0xe436ba58406c69a63a9611a11eb52314c5c17ba9eaaa7dab8506fe8849517286`
- **Registrar Pricing:** ~0.001 ETH/year (32000 wei/second)
- **Min Commitment Age:** 60 seconds
- **Min Duration:** 60 seconds
- **Max Duration:** `type(uint64).max`
- **Min Label Length:** 3
- **Max Label Length:** 64

## Registration Commitments

### name-stars

- **Label:** `name-stars`
- **Duration:** 365 days
- **Commitment Hash:** `0x28a43c33aaf587976fbd8c316a3f0200f45c0b26c791051fe87bdfb14f692c8f`
- **Secret:** `0xfd7520895875ecd4c9679ffe6514f5f6b837c3e4d644b62afc4ec8d21e6e51c5`
- **Status:** Committed (pending registration)

## Deployment Costs

- **Total Gas Used:** 7,336,072 gas
- **Total Cost:** 0.000007336072 ETH (~$0.02)
- **Gas Price:** 0.001 gwei

## Environment Variables

Add these to your `.env` file for use with `RegisterAndSetup.s.sol`:

```bash
ECS_REGISTRY_ADDRESS=0xC052964dF22319FF79E1ab4BbD08897df81e4B95
ECS_REGISTRAR_ADDRESS=0x83E1b31806e6A3BC587A0C9b8582e006c880c9B7
CREDENTIAL_RESOLVER_ADDRESS=0x4a818ae07f661EDFfbaa4aaFdab9c00085Ff6C78
ROOT_NODE=0xe436ba58406c69a63a9611a11eb52314c5c17ba9eaaa7dab8506fe8849517286
REGISTRATION_SECRET=0xfd7520895875ecd4c9679ffe6514f5f6b837c3e4d644b62afc4ec8d21e6e51c5
```

## Next Steps

1. Wait at least 60 seconds after deployment
2. Run `RegisterAndSetup.s.sol` to complete the registration and set credential records
3. Set the **manager** of `ecs.eth` to the ECS Registry address (`0xC052964dF22319FF79E1ab4BbD08897df81e4B95`) in the ENS app/Registry
   - Note: For `.eth` names registered via the ENS Registrar (ERC-721), the Registrar contract is the owner in the Registry, and you can set a "manager" (shown in the UI) that can set records. The ECS Registry needs to be set as the manager so it can create subnodes.

## Transaction Details

All transactions were included in block `9755968` on Sepolia.

### Transaction Sequence

1. Grant role (internal setup)
2. Set registrar parameters
3. Deploy ECSRegistry
4. Deploy ECSRegistrar
5. Set registrar pricing
6. Deploy CredentialResolver
7. Commit registration for `name-stars`

## Verification

- **Explorer:** [Sepolia Etherscan](https://sepolia.etherscan.io/)
- **Registry:** [0xC052964dF22319FF79E1ab4BbD08897df81e4B95](https://sepolia.etherscan.io/address/0xC052964dF22319FF79E1ab4BbD08897df81e4B95)
- **Registrar:** [0x83E1b31806e6A3BC587A0C9b8582e006c880c9B7](https://sepolia.etherscan.io/address/0x83E1b31806e6A3BC587A0C9b8582e006c880c9B7)
- **Resolver:** [0x4a818ae07f661EDFfbaa4aaFdab9c00085Ff6C78](https://sepolia.etherscan.io/address/0x4a818ae07f661EDFfbaa4aaFdab9c00085Ff6C78)

## Architecture Notes

The CredentialResolver is now a **single-label resolver**, meaning:
- One CredentialResolver contract serves one label (e.g., `name-stars.ecs.eth`)
- Only the contract owner can set records
- No `labelhash` parameter needed for setter/getter functions
- Simplified storage: `mapping(string => string)` for text records, etc.
- The `resolve()` function ignores the `name` parameter since it only serves one label

